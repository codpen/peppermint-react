{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/japot/Desktop/Peppermint/Peppermint/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/japot/Desktop/Peppermint/Peppermint/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React,{useEffect,useContext}from\"react\";import{Space,Table,Button,Popconfirm}from\"antd\";import{useHistory}from\"react-router-dom\";import{GlobalContext}from\"../../Context/GlobalState\";import Edit from\"../../components/users/Edit\";import Reset from\"../../components/users/Reset\";import Create from\"../../components/users/Create\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Auth=function Auth(){var history=useHistory();var _useContext=useContext(GlobalContext),users=_useContext.users,getUsers=_useContext.getUsers;useEffect(function(){function auth(){return _auth.apply(this,arguments);}function _auth(){_auth=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"/api/v1/auth/token\",{method:\"GET\",headers:{\"Content-Type\":\"application/json\",Accept:\"application/json\"}}).then(function(response){return response.json();}).then(function(response){console.log(response);var res=response;if(res.auth===false){history.push(\"/login\");}else{return console.log(\"logged in\");}});case 2:case\"end\":return _context.stop();}}},_callee);}));return _auth.apply(this,arguments);}auth();// eslint-disable-next-line\n},[]);var deleteClient=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(client){var id;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:id=client.id;_context2.prev=1;_context2.next=4;return fetch(\"/api/v1/auth/delete/\".concat(id),{method:\"DELETE\",headers:{Authorization:\"Bearer \"+localStorage.getItem(\"jwt\"),\"Content-Type\":\"application/json\",Accept:\"application/json\"}}).then(function(response){return response.json();});case 4:_context2.next=9;break;case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](1);console.log(_context2.t0);case 9:case\"end\":return _context2.stop();}}},_callee2,null,[[1,6]]);}));return function deleteClient(_x){return _ref.apply(this,arguments);};}();useEffect(function(){getUsers();},[]);var columns=[{title:\"Name\",dataIndex:\"firstName\",key:\"name\"},{title:\"Email\",dataIndex:\"email\",key:\"email\"},{key:\"action\",responsive:[\"md\"],render:function render(text,record){return/*#__PURE__*/_jsxs(Space,{size:\"middle\",children:[/*#__PURE__*/_jsx(Edit,{user:record}),/*#__PURE__*/_jsx(Popconfirm,{title:\"Are you sure you want to delete?\",onConfirm:function onConfirm(){return deleteClient(record);},children:/*#__PURE__*/_jsx(Button,{children:\"Delete\"})}),/*#__PURE__*/_jsx(Reset,{user:record})]});}}];return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"main\",{className:\"relative z-0 overflow-y-auto focus:outline-none\",tabindex:\"0\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"py-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-row max-w-7xl mx-auto px-4 sm:px-6 md:px-8\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-semibold text-gray-900\",children:\"Internal Users\"}),/*#__PURE__*/_jsx(\"div\",{className:\"ml-3\",children:/*#__PURE__*/_jsx(Create,{})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"max-w-7xl mx-auto px-4 sm:px-6 md:px-8\",children:/*#__PURE__*/_jsx(\"div\",{className:\"py-4\",children:/*#__PURE__*/_jsx(Table,{dataSource:users,columns:columns,pagination:{defaultPageSize:10,showSizeChanger:true,pageSizeOptions:[\"10\",\"20\",\"30\"]}})})})]})})})});};export default Auth;","map":{"version":3,"sources":["C:/Users/japot/Desktop/Peppermint/Peppermint/client/src/pages/admin/Auth.js"],"names":["React","useEffect","useContext","Space","Table","Button","Popconfirm","useHistory","GlobalContext","Edit","Reset","Create","Auth","history","users","getUsers","auth","fetch","method","headers","Accept","then","response","json","console","log","res","push","deleteClient","client","id","Authorization","localStorage","getItem","columns","title","dataIndex","key","responsive","render","text","record","defaultPageSize","showSizeChanger","pageSizeOptions"],"mappings":"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","sourcesContent":["import React, { useEffect, useContext } from \"react\";\r\nimport { Space, Table, Button, Popconfirm } from \"antd\";\r\nimport { useHistory } from \"react-router-dom\";\r\n\r\nimport { GlobalContext } from \"../../Context/GlobalState\";\r\n\r\nimport Edit from \"../../components/users/Edit\";\r\nimport Reset from \"../../components/users/Reset\";\r\nimport Create from \"../../components/users/Create\";\r\n\r\nconst Auth = () => {\r\n  const history = useHistory();\r\n  const { users, getUsers } = useContext(GlobalContext);\r\n\r\n  useEffect(() => {\r\n    async function auth() {\r\n      await fetch(`/api/v1/auth/token`, {\r\n        method: \"GET\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          Accept: \"application/json\",\r\n        },\r\n      })\r\n        .then((response) => response.json())\r\n        .then((response) => {\r\n          console.log(response);\r\n          const res = response;\r\n          if (res.auth === false) {\r\n            history.push(\"/login\");\r\n          } else {\r\n            return console.log(\"logged in\");\r\n          }\r\n        });\r\n    }\r\n    auth();\r\n    // eslint-disable-next-line\r\n  }, []);\r\n\r\n  const deleteClient = async (client) => {\r\n    const id = client.id;\r\n    try {\r\n      await fetch(`/api/v1/auth/delete/${id}`, {\r\n        method: \"DELETE\",\r\n        headers: {\r\n          Authorization: \"Bearer \" + localStorage.getItem(\"jwt\"),\r\n          \"Content-Type\": \"application/json\",\r\n          Accept: \"application/json\",\r\n        },\r\n      }).then((response) => response.json());\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    getUsers();\r\n  }, []);\r\n\r\n  const columns = [\r\n    {\r\n      title: \"Name\",\r\n      dataIndex: \"firstName\",\r\n      key: \"name\",\r\n    },\r\n    {\r\n      title: \"Email\",\r\n      dataIndex: \"email\",\r\n      key: \"email\",\r\n    },\r\n    {\r\n      key: \"action\",\r\n      responsive: [\"md\"],\r\n      render: (text, record) => (\r\n        <Space size=\"middle\">\r\n            <Edit user={record} />\r\n          <Popconfirm\r\n            title=\"Are you sure you want to delete?\"\r\n            onConfirm={() => deleteClient(record)}\r\n          >\r\n            <Button>Delete</Button>\r\n          </Popconfirm>\r\n          <Reset user={record} />\r\n        </Space>\r\n      ),\r\n    },\r\n  ];\r\n\r\n  return (\r\n    <div>\r\n      <div>\r\n        <main\r\n          className=\"relative z-0 overflow-y-auto focus:outline-none\"\r\n          tabindex=\"0\"\r\n        >\r\n          <div className=\"py-6\">\r\n            <div className=\"flex flex-row max-w-7xl mx-auto px-4 sm:px-6 md:px-8\">\r\n              <h1 className=\"text-2xl font-semibold text-gray-900\">\r\n              Internal Users\r\n              </h1>\r\n              <div className=\"ml-3\">\r\n                <Create />\r\n              </div>\r\n            </div>\r\n            <div className=\"max-w-7xl mx-auto px-4 sm:px-6 md:px-8\">\r\n              <div className=\"py-4\">\r\n                <Table\r\n                  dataSource={users}\r\n                  columns={columns}\r\n                  pagination={{\r\n                    defaultPageSize: 10,\r\n                    showSizeChanger: true,\r\n                    pageSizeOptions: [\"10\", \"20\", \"30\"],\r\n                  }}\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </main>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Auth;\r\n"]},"metadata":{},"sourceType":"module"}